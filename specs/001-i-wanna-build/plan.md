# Implementation Plan: Video call rooms with token-based joining and grid view

**Branch**: `001-i-wanna-build` | **Date**: 2025-09-25 | **Spec**: ./researching/video-call/specs/001-i-wanna-build/spec.md
**Input**: Feature specification from `/researching/video-call/specs/001-i-wanna-build/spec.md`

## Execution Flow (/plan command scope)

```
1. Load feature spec from Input path
2. Fill Technical Context (scan for NEEDS CLARIFICATION)
3. Fill the Constitution Check section based on the constitution document
4. Evaluate Constitution Check section
5. Execute Phase 0 → research.md
6. Execute Phase 1 → contracts, data-model.md, quickstart.md
7. Re-evaluate Constitution Check section
8. Plan Phase 2 → Describe task generation approach (DO NOT create tasks.md)
9. STOP - Ready for /tasks command
```

IMPORTANT: The /plan command STOPS at step 7. Phases 2-4 are executed by other commands.

## Summary

- Primary requirement: Users can create a room and others join via a tokenized URL; participants appear in a dynamic grid with A/V.
- Approved stack: Node.js server (tsx + TypeScript) with Socket.IO; React + Vite frontend using shadcn/ui; route scheme `/rooms` and `/rooms/[id]?token=jwt_token`.

## Technical Context

- Language/Version: TypeScript (Node 20+), React 18+
- Primary Dependencies: Socket.IO, WebRTC APIs (browser), shadcn/ui, Vite
- Storage: N/A
- Target Platform: Web (modern desktop and mobile browsers)
- Project Type: web (frontend + backend)
- Performance Goals: fast join (<2s signaling), low A/V latency (best-effort via WebRTC)
- Constraints: Token-protected access; dynamic grid rendering; reconnection best-effort
- Scale/Scope: Small MVP rooms; capacity configurable
- Unknowns flagged in spec remain pending by explicit user override (see research.md)

## Constitution Check

- Constitution mandates: Next.js (App Router) + TypeScript (see researching/video-call/.specify/memory/constitution.md).
- Approved exception: React + Vite frontend with separate Node server. Documented below.
- Gate Result: PASS with exception documented in Complexity Tracking.

## Project Structure

### Documentation (this feature)

```
researching/video-call/specs/001-i-wanna-build/
├── plan.md
├── research.md
├── data-model.md
├── quickstart.md
├── contracts/
└── tasks.md  (generated by /tasks)
```

### Source Code (repository root)

```
backend/
├── src/
│   ├── api/
│   ├── signaling/
│   └── lib/

frontend/
├── src/
│   ├── pages/
│   ├── components/
│   └── services/
```

**Structure Decision**: Web application (frontend + backend).

## Phase 0: Outline & Research

See `research.md` for unknowns and decisions. Proceeding under explicit override; unresolved items are carried forward to tasks.

## Phase 1: Design & Contracts

- Entities extracted in `data-model.md`.
- API contracts at `contracts/openapi.yaml` for:
  - POST /rooms (create room)
  - GET /rooms/{id} (validate/join with token query)
- Quickstart flows are in `quickstart.md`.

## Phase 2: Task Planning Approach

- /tasks will generate tasks.md from Phase 1 outputs (contracts, data-model, quickstart), using TDD ordering and [P] markers for parallelizable work.

## Complexity Tracking

| Violation                           | Why Needed                                 | Simpler Alternative Rejected Because                                              |
| ----------------------------------- | ------------------------------------------ | --------------------------------------------------------------------------------- |
| Frontend not Next.js (Vite + React) | Matches user requirement and speed for MVP | Next.js mandate is general; this feature prototypes signaling + WebRTC UI quickly |

## Progress Tracking

- [ ] Phase 0: Research complete (/plan)
- [ ] Phase 1: Design complete (/plan)
- [x] Phase 2: Task planning described (not executed)
- [ ] Phase 3: Tasks generated (/tasks)
- [ ] Phase 4: Implementation complete
- [ ] Phase 5: Validation passed

**Gate Status**:

- [x] Initial Constitution Check: PASS (with documented exception)
- [ ] Post-Design Constitution Check: PASS
- [ ] All NEEDS CLARIFICATION resolved (carried by override)
- [x] Complexity deviations documented
